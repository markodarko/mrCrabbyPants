class Textbox {
constructor(string,x,y,speed=0,size=4,centered=1,color='white'){
	this.letters = TEXBOX_LETTERS
	this.message=string;
	this.speed = speed;
	this.startx = x;
	this.y=y;
	this.font = {pxsize: size, gap: size, centered:centered, color: color}
	this.resetText();
	}
	resetText(){
	this.x = this.startx;
	this.wordLength = 0;
	if (this.speed == 0)this.count = this.message.length
	else this.count = 0;
	this.timer = this.speed;
	}
	update(){
		if (this.speed == 0){this.count = this.message.length; return} 
		if(this.timer % this.speed == 0) {
			this.increaseLength()
			this.count = Math.min(this.count+1, this.message.length);
		}
		this.timer++
	}

	draw(){
		
		//this.makeWordBubble()
		this.writeMessage()
	}
	
	increaseLength(){
		if (this.count < this.message.length){
			let currentLetter = this.letters[this.message[this.count]]
			if (currentLetter == undefined)return;
			this.wordLength += currentLetter[0].length * this.font.pxsize + this.font.gap
			this.x = this.startx - Math.floor(this.wordLength/2) * this.font.centered
		}
	}
			
	
	makeWordBubble(){
		const scale = this.font.pxsize 
		ctx.fillStyle = 'white'
		ctx.fillRect(this.x-2,this.y-2, this.wordLength+5, 10*scale)
		ctx.fillRect(this.startx,this.y+8, 2, 2)
		ctx.fillRect(this.startx+2,this.y+8, 2, 4)
	}  

	writeMessage(){
		//ctx.fillStyle = this.font.color
		let space = 0, str = this.message, letter
		
		for(let i = 0 ; i < this.count; i++){
			letter = this.letters[str[i]]
			if (letter != undefined){
			this.writeletter(this.x + space, letter)	
			space += letter[0].length * this.font.pxsize + this.font.gap
			}
		}
		if (this.wordLength < space) this.wordLength = space

	}

	writeletter(x,letter){
		let s = this.font.pxsize 
		for (let i = 0; i < letter.length; i++){
			let row = letter[i]
		for (let j = 0 ; j < row.length ; j++){
			if (row[j] == 1)
			ctx.fillRect(x + j*s ,this.y + i * s, s, s)
			
			}
		}
	}
}
	
const TEXBOX_LETTERS = 
	{
	' ':[
	'...',
	'...',
	'...',
	'...',
	'...'
	],
	A:[
	'.1.',
	'1.1',
	'111',
	'1.1',
	'1.1'
	],
	a:[
	'....',
	'....',
	'111.',
	'1.1.',
	'11.1'
	],
	B:[
	'11.',
	'1.1',
	'111',
	'1.1',
	'111'
	],
	b:[
	'1..',
	'1..',
	'111',
	'1.1',
	'111'
	],
	C:[
	'.11',
	'1..',
	'1..',
	'1..',
	'111'
	],
	c:[
	'...',
	'...',
	'.11',
	'1..',
	'111'
	],
	D:[
	'11.',
	'1.1',
	'1.1',
	'1.1',
	'11.'
	],
	d:[
	'..1',
	'..1',
	'111',
	'1.1',
	'111'
	],
	E:[
	'.11',
	'1..',
	'11.',
	'1..',
	'111'
	],
	e:[
	'...',
	'.1.',
	'1.1',
	'11.',
	'111'
	],
	F:[
	'111',
	'1..',
	'11.',
	'1..',
	'1..'
	],
	f:[
	'..1',
	'.1.',
	'111',
	'.1.',
	'.1.'
	],
	G:[
	'.11.',
	'1...',
	'1.11',
	'1..1',
	'.11.'
	],
	g:[
	'...',
	'.1.',
	'1.1',
	'111',
	'..1',
	'.1.'
	],
	H:[
	'1.1',
	'1.1',
	'111',
	'1.1',
	'1.1'
	],
	h:[
	'1..',
	'1..',
	'11.',
	'1.1',
	'1.1'
	],
	I:[
	'111',
	'.1.',
	'.1.',
	'.1.',
	'111'
	],
	i:[
	'1',
	'.',
	'1',
	'1',
	'1'
	],
	J:[
	'111',
	'.1.',
	'.1.',
	'.1.',
	'1..'
	],
	j:[
	'.1',
	'..',
	'.1',
	'.1',
	'.1',
	'1.'
	],
	K:[
	'1.1',
	'1.1',
	'11.',
	'1.1',
	'1.1'
	],
	k :[
	'1..',
	'1.1',
	'11.',
	'1.1',
	'1.1'
	],
	L:[
	'1.',
	'1.',
	'1.',
	'1.',
	'11'
	],
	l:[
	'1',
	'1',
	'1',
	'1',
	'1'
	],
	M:[
	'11.11',
	'1.1.1',
	'1.1.1',
	'1...1',
	'1...1'
	],
	m:[
	'.....',
	'.....',
	'1111.',
	'1.1.1',
	'1...1'
	],
	N:[
	'11.1',
	'1.11',
	'1..1',
	'1..1',
	'1..1'
	],
	n:[
	'...',
	'...',
	'11.',
	'1.1',
	'1.1'
	],
	O:[
	'.11',
	'1.1',
	'1.1',
	'1.1',
	'111'
	],
	o:[
	'...',
	'...',
	'111',
	'1.1',
	'111'
	],
	P:[
	'11.',
	'1.1',
	'111',
	'1..',
	'1..'
	],
	p:[
	'...',
	'...',
	'11.',
	'1.1',
	'111',
	'1..'
	],
	Q:[
	'.11.',
	'1..1',
	'1..1',
	'11.1',
	'.11.',
	'...1'
	],
	q:[
	'....',
	'....',
	'.11.',
	'1.1.',
	'111.',
	'..11'
	],
	R:[
	'11.',
	'1.1',
	'11.',
	'1.1',
	'1.1'
	],
	r:[
	'..',
	'..',
	'11',
	'1.',
	'1.'
	],
	S:[
	'111',
	'11.',
	'..1',
	'..1',
	'111'
	],
	s:[
	'...',
	'111',
	'11.',
	'..1',
	'111'
	],
	T:[
	'111',
	'.1.',
	'.1.',
	'.1.',
	'.1.'
	],
	t:[
	'..',
	'1.',
	'11',
	'1.',
	'.1'
	],
	U:[
	'1..1',
	'1..1',
	'1..1',
	'1..1',
	'1111'
	],
	u:[
	'...',
	'...',
	'1.1',
	'1.1',
	'111'
	],
	V:[
	'1.1',
	'1.1',
	'1.1',
	'1.1',
	'.1.'
	],
	v:[
	'...',
	'...',
	'1.1',
	'1.1',
	'.1.'
	],
	W:[
	'1...1',
	'1...1',
	'1.1.1',
	'1.1.1',
	'11.11'
	],
	w:[
	'.....',
	'.....',
	'1.1.1',
	'1.1.1',
	'1111.'
	],
	X:[
	'1.1',
	'1.1',
	'.1.',
	'1.1',
	'1.1'
	],
	x:[
	'...',
	'...',
	'1.1',
	'.1.',
	'1.1'
	],
	Y:[
	'1.1',
	'1.1',
	'.1.',
	'.1.',
	'.1.'
	],
	y:[
	'...',
	'...',
	'1.1',
	'111',
	'..1',
	'.1.'
	],
	Z:[
	'111',
	'..1',
	'.1.',
	'1..',
	'111'
	],
	z:[
	'..',
	'11',
	'.1',
	'1.',
	'11'
	],
	1:[
	'.1',
	'11',
	'.1',
	'.1',
	'.1'
	],
	2:[
	'111',
	'..1',
	'111',
	'1..',
	'111'
	],
	3:[
	'111',
	'..1',
	'.11',
	'..1',
	'111'
	],
	4:[
	'1.1',
	'1.1',
	'111',
	'..1',
	'..1'
	],
	5:[
	'111',
	'1..',
	'111',
	'..1',
	'111'
	],
	6:[
	'.1.',
	'1..',
	'111',
	'1.1',
	'111'
	],
	7:[
	'111',
	'..1',
	'.1.',
	'.1.',
	'.1.'
	],
	8:[
	'111',
	'1.1',
	'111',
	'1.1',
	'111'
	],
	9:[
	'111',
	'1.1',
	'111',
	'..1',
	'..1'
	],
	0:[
	'111',
	'1.1',
	'1.1',
	'1.1',
	'111'
	],
	'(':[
	'.1',
	'1.',
	'1.',
	'1.',
	'.1'
	],
	')':[
	'1.',
	'.1',
	'.1',
	'.1',
	'1.'
	],
	'!':[
	'11',
	'11',
	'1.',
	'..',
	'1.'
	],
	'?':[
	'111',
	'..1',
	'.1.',
	'...',
	'.1.'
	],
	':':[
	'.',
	'1',
	'.',
	'.',
	'1'
	],
	'.':[
	'.',
	'.',
	'.',
	'.',
	'1'
	],
	',':[
	'.',
	'.',
	'.',
	'.',
	'1',
	'1'
	],
	'\"':[
	'1.1',
	'1.1',
	'...',
	'...',
	'...'
	],
	'\'':[
	'11',
	'.1',
	'..',
	'..',
	'..'
	],
	'&':[
	'.1...',
	'1.1..',
	'.1..1',
	'1..1.',
	'.11.1.'
	]
	};
		

